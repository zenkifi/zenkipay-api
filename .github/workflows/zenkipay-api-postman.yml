# This GitHub Actions workflow was generated by the `Zenkipay team` on 2023-01-31
# You can view our full documentation here: https://docs.readme.com/docs/rdme
name: Postman repository update

on:
  push:
    branches:
      # This workflow will run every time you push code to the following branch: `main`
      # Check out GitHub's docs for more info on configuring this:
      # https://docs.github.com/actions/using-workflows/events-that-trigger-workflows
      - 'main'
    paths:
      - 'Zenkipay-API-v1-EN.yaml'
      - '.github/workflows/zenkipay-api-postman.yml'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout local repository zenkipay-api
        uses: actions/checkout@v3

      - name: Actualizando especificación en directorio de Postman
        run: |
          rm -rfv postman/schemas/Zenkipay-API-v1-EN.yaml
          cp Zenkipay-API-v1-EN.yaml postman/schemas/

      - name: Subiendo especificación actualizada al repositorio de Postman
        run: |
            RepoStatus=$(git status -uno | grep "up to date") 
            if [ "$RepoStatus" = "Your branch is up to date with 'origin/main'" ]; then
              echo "No ha habido cambios en el repositorio $RepoStatus"
            else
              git config user.name github-actions
              git config user.email github-actions@github.com
              git add postman/schemas/Zenkipay-API-v1-EN.yaml
              git commit -m "Se actualiza especificación de API a repo. de Postman"
              git push
            fi